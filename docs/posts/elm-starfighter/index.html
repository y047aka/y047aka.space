<!DOCTYPE html>
  <html lang="en">
  <head>
    <link rel="stylesheet" href="/style.css">
    
    <link rel="preload" href="/elm.js" as="script">
    <link rel="modulepreload" href="/index.js">
    
    <script defer="defer" src="/elm.js" type="text/javascript"></script>
    <base href="../../">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <script type="module">
import userInit from"/index.js";
let prefetchedPages=[window.location.pathname],initialLocationHash=document.location.hash.replace(/^#/,"");function loadContentAndInitializeApp(){let a=window.location.pathname.replace(/(w)$/,"$1/");a.endsWith("/")||(a+="/");const b=Elm.TemplateModulesBeta.init({flags:{secrets:null,baseUrl:document.baseURI,isPrerendering:!1,isDevServer:!1,isElmDebugMode:!1,contentJson:JSON.parse(document.getElementById("__ELM_PAGES_DATA__").innerHTML),userFlags:userInit.flags()}});return b.ports.toJsPort.subscribe(()=>{loadNamedAnchor()}),b}function loadNamedAnchor(){if(""!==initialLocationHash){const a=document.querySelector(`[name=${initialLocationHash}]`);a&&a.scrollIntoView()}}function prefetchIfNeeded(a){if(a.host===window.location.host&&!prefetchedPages.includes(a.pathname)){prefetchedPages.push(a.pathname),console.log("Preloading...",a.pathname);const b=document.createElement("link");b.setAttribute("as","fetch"),b.setAttribute("rel","prefetch"),b.setAttribute("href",origin+a.pathname+"/content.json"),document.head.appendChild(b)}}const appPromise=new Promise(function(a){document.addEventListener("DOMContentLoaded",()=>{a(loadContentAndInitializeApp())})});userInit.load(appPromise),"function"==typeof connect&&connect(function(a){appPromise.then(b=>{b.ports.fromJsPort.send({contentJson:a})})});const trigger_prefetch=b=>{const c=find_anchor(b.target);c&&c.href&&c.hasAttribute("elm-pages:prefetch")&&prefetchIfNeeded(c)};let mousemove_timeout;const handle_mousemove=a=>{clearTimeout(mousemove_timeout),mousemove_timeout=setTimeout(()=>{trigger_prefetch(a)},20)};addEventListener("touchstart",trigger_prefetch),addEventListener("mousemove",handle_mousemove);function find_anchor(a){for(;a&&"A"!==a.nodeName.toUpperCase();)a=a.parentNode;return a}
    </script>
    <title>Elm での開発用テンプレート elm-starfighter を作った - y047aka.space</title>
    <meta name="generator" content="elm-pages v1.5.5">
    <link rel="manifest" href="manifest.json">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <script type="application/ld+json">
{"@context":"http://schema.org/","@type":"Article","headline":"Elm での開発用テンプレート elm-starfighter を作った","description":"","image":"","author":{"@type":"Person","name":""},"publisher":{"@type":"Person","name":""},"url":"","datePublished":"2019-07-06","mainEntityOfPage":{"@type":"SoftwareSourceCode","codeRepository":"https://github.com/y047aka/y047aka.space","description":"My site.","author":"Yoshitaka Totsuka","programmingLanguage":{"@type":"ComputerLanguage","url":"http://elm-lang.org/","name":"Elm","image":"http://elm-lang.org/","identifier":"http://elm-lang.org/"}}}
</script>    <link rel="canonical" href="https://y047aka.space/posts/elm-starfighter" />    <meta name="description" content="" />    <meta property="og:image" content="https://y047aka.space/images/icon-png.png" />    <meta property="og:image:secure_url" content="https://y047aka.space/images/icon-png.png" />    <meta property="og:image:alt" content="y047aka.space logo" />    <meta property="og:title" content="Elm での開発用テンプレート elm-starfighter を作った" />    <meta property="og:url" content="https://y047aka.space/posts/elm-starfighter" />    <meta property="og:description" content="" />    <meta property="og:site_name" content="y047aka.space" />    <meta property="twitter:card" content="summary_large_image" />    <meta property="twitter:title" content="Elm での開発用テンプレート elm-starfighter を作った" />    <meta property="twitter:description" content="" />    <meta property="twitter:image" content="https://y047aka.space/images/icon-png.png" />    <meta property="twitter:image:alt" content="y047aka.space logo" />    <meta property="og:type" content="article" />    <meta property="article:published_time" content="2019-07-06" />    <link rel="sitemap" type="application/xml" href="/sitemap.xml" />
    <script id="__ELM_PAGES_DATA__" type="application/json">{"is404":false,"staticData":{"markdown-blocks-content/posts/elm-starfighter.md":"[1,[[6,[[8,\"自作の Elm 開発用テンプレート「 \"],[2,\"https://github.com/y047aka/elm-starfighter\",[0],[[8,\"elm-starfighter\"]]],[8,\" 」が形になってきたので、その説明を書きます。\"]]],[5,[0],[[8,\"elm-starfighter とは？\"]]],[6,[[8,\"関数型言語 \"],[2,\"https://elm-lang.org\",[0],[[8,\"Elm\"]]],[8,\" を使った Web アプリケーション開発用のテンプレートです。webpack や Parcel といったモジュールバンドラーを使用せず、\"],[7,\"npm scripts\"],[8,\" で完結しています。Elm での開発に最低限必要なものをシンプルに使えるのが、elm-starfighter の特徴です。\"]]],[2,[[0,[0],[[2,\"https://github.com/y047aka/elm-starfighter\",[0],[[8,\"elm-starfighter\"]]]]]]],[5,[1],[[8,\"なぜ作ろうと思ったのか？\"]]],[6,[[8,\"JavaScript での開発と同様に、Elm においても webpack や Parcel を使った開発方法が普及しています。しかし、Elm はモジュールバンドラーを必要とはしていないかもしれません。それならばモジュールバンドラーに頼らない、よりシンプルな開発ができるのではないかと考えました。\"]]],[6,[[8,\"既に知られている \"],[2,\"https://github.com/halfzebra/create-elm-app\",[0],[[8,\"create-elm-app\"]]],[8,\" や \"],[2,\"https://github.com/elm-community/elm-webpack-starter\",[0],[[8,\"elm-webpack-starter\"]]],[8,\" に対して「毎回使うには大きすぎる」と感じたことも動機の 1 つです。Elm 入門者が簡単に使える開発ツールがあれば、Elm の持つ魅力をもっと引き出せるのではないかと思います。\"]]],[5,[1],[[8,\"開発の方針\"]]],[5,[2],[[8,\"Elm 入門者に優しく\"]]],[6,[[8,\"公式ガイドや『基礎からわかる Elm』を読んだあとで、すぐに使ってもらえるよう意識して作りました。使い方に迷うようなところがあれば改善していきたい。\"]]],[5,[2],[[8,\"Elm の持つ魅力を引き出す\"]]],[6,[[8,\"JavaScript と Elm では何が違うのかを意識しながら作りました。標準の \"],[7,\"elm make\"],[8,\" コマンドはデバッグ機能を使うことができますし、そこに開発用サーバー機能を付加した \"],[7,\"elm-live\"],[8,\" も非常に強力です。それらの良さを残しつつ、苦手な部分を補うようにしました。\"]]],[5,[2],[[8,\"モジュールバンドラーと戦わない\"]]],[6,[[8,\"適材適所を意識すること。例えば、Port を積極的に使うならモジュールバンドラーの方が有利のはず。\\n（私は Port をほとんど使わないので、推測で言っています）\"]]],[5,[1],[[8,\"謝辞\"]]],[6,[[8,\"@ababup1192 さんには、開発初期の段階で多くの相談に乗っていただきました。ありがとうございました。\"]]],[5,[0],[[8,\"簡単に使えるので書くことがない\"]]],[6,[[8,\"いちばん簡単な試し方は以下のコマンドを実行する方法です。\"]]],[8,[\"$ git clone https://github.com/y047aka/elm-starfighter.git\\n$ cd elm-startfighter\\n$ npm install\\n$ npm start\\n\",[0]]],[6,[[8,\"また、リポジトリのトップから緑色のボタン「Use this template」を選択すると、elm-starfighter を使った新しいリポジトリを作る事もできます。\\n\"],[3,\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/406109/3faa5b0f-8ff3-9280-fa09-6ba62e3495e8.png\",[0],[]]]],[5,[1],[[8,\"npm start\"]]],[6,[[7,\"npm start\"],[8,\" を実行すると、\"]]],[3,1,[[[7,\"docs\"],[8,\" にファイルが生成され\"]],[[8,\"開発用サーバーが起動し\"]],[[8,\"ブラウザに最初のページが表示されます\"]]]],[5,[1],[[8,\"npm run build\"]]],[6,[[8,\"もう 1 つのコマンドは \"],[7,\"npm run build\"],[8,\" で起動します。\"]]],[3,1,[[[7,\"public\"],[8,\" にファイルが生成されます\"]]]],[6,[[8,\"生成前のファイルはすべて \"],[7,\"src\"],[8,\" にあるので、いつも通りに開発を進められます。\"]]],[8,[\"src\\n - index.html\\n - main.js\\n - Main.elm\\n - style.sass または style.sass\\n - assets（画像など）\\n\",[0]]],[5,[1],[[8,\"ディレクトリ名について\"]]],[6,[[7,\"docs\"],[8,\" は Github Pages を、\"],[7,\"public\"],[8,\" は Netlify をすぐに使えるよう意図して設定しています。\"]]],[5,[0],[[8,\"おわり\"]]],[6,[[8,\"この記事の本編は、ここで終了です。\\nカスタマイズして使う場合には以下の付録を参考にしてください。\"]]],[5,[0],[[8,\"付録 1： package.json を読む\"]]],[6,[[8,\"ここに elm-starfighter のすべてがあります。webpack や Parcel の姿はなく、代わりに \"],[7,\"npm scripts\"],[8,\" が並んでいます。\"],[7,\"elm make\"],[8,\" コマンドや \"],[7,\"elm-live\"],[8,\" を使っていることが分かりますね。これから \"],[7,\"scripts\"],[8,\" を詳しく見ていきましょう。\"]]],[8,[\"{\\n  \\\"scripts\\\": {\\n    \\\"clean\\\": \\\"rimraf docs public\\\",\\n    \\\"watch:html\\\": \\\"cpx -w src/index.html docs\\\",\\n    \\\"watch:assets\\\": \\\"cpx -w \\\\\\\"src/assets/**/*\\\\\\\" docs/assets\\\",\\n    \\\"watch:js\\\": \\\"cpx -w src/main.js docs\\\",\\n    \\\"watch:elm\\\": \\\"elm-live src/Main.elm --open --start-page=index.html --dir=docs -- --output=docs/elm.js\\\",\\n    \\\"watch:sass\\\": \\\"sass --watch src:docs\\\",\\n    \\\"watch\\\": \\\"sass src:docs && npm-run-all -p watch:*\\\",\\n    \\\"compile:html\\\": \\\"cpx src/index.html public\\\",\\n    \\\"compile:assets\\\": \\\"cpx \\\\\\\"src/assets/**/*\\\\\\\" public/assets\\\",\\n    \\\"compile:js\\\": \\\"cpx src/main.js public\\\",\\n    \\\"compile:elm\\\": \\\"elm make src/Main.elm --optimize --output=public/elm.optimized.js\\\",\\n    \\\"compile:sass\\\": \\\"sass --style=compressed --no-source-map src:public\\\",\\n    \\\"compile\\\": \\\"npm-run-all -p compile:*\\\",\\n    \\\"minify:elm\\\": \\\"google-closure-compiler --js=public/elm.optimized.js --js_output_file=public/elm.js && rimraf public/elm.optimized.js\\\",\\n    \\\"build\\\": \\\"npm-run-all -s clean compile minify:elm\\\",\\n    \\\"start\\\": \\\"npm-run-all -s clean watch\\\",\\n    \\\"test\\\": \\\"elm-test\\\"\\n  },\\n  \\\"devDependencies\\\": {\\n    \\\"cpx\\\": \\\"^1.5.0\\\",\\n    \\\"elm\\\": \\\"0.19.0-bugfix6\\\",\\n    \\\"elm-live\\\": \\\"3.4.0\\\",\\n    \\\"elm-test\\\": \\\"^0.19.0-rev6\\\",\\n    \\\"google-closure-compiler\\\": \\\"^20190819.0.0\\\",\\n    \\\"npm-run-all\\\": \\\"^4.1.5\\\",\\n    \\\"rimraf\\\": \\\"^3.0.0\\\",\\n    \\\"sass\\\": \\\"^1.22.10\\\"\\n  }\\n}\\n\",[1,\"package.json\"]]],[5,[1],[[8,\"npm scripts\"]]],[6,[[8,\"以下の 4 種類のコマンドを \"],[7,\"start\"],[8,\" と \"],[7,\"build\"],[8,\" から実行しています。\"]]],[2,[[0,[0],[[8,\"clean\"]]],[0,[0],[[8,\"watch\"]]],[0,[0],[[8,\"compile\"]]],[0,[0],[[8,\"minify:elm\"]]]]],[5,[2],[[8,\"start\"]]],[6,[[7,\"clean\"],[8,\" と \"],[7,\"watch\"],[8,\" を順番に実行します。\"]]],[8,[\"\\\"start\\\": \\\"npm-run-all -s clean watch\\\"\\n\",[1,\"json\"]]],[6,[[8,\"生成したファイルは \"],[7,\"docs\"],[8,\" に出力されます。出力先のディレクトリ名を変更する場合は、以下のコマンド内の \"],[7,\"docs\"],[8,\" を新しい名前に書き直します。（実際には package.json をエディタで一括変換すれば問題ありません）\"]]],[5,[2],[[8,\"clean\"]]],[6,[[7,\"docs\"],[8,\" と \"],[7,\"public\"],[8,\" ディレクトリを 2 つとも削除します。このコマンドのみ、\"],[7,\"build\"],[8,\" と共有しています。\"]]],[8,[\"\\\"clean\\\": \\\"rimraf docs public\\\"\\n\",[1,\"json\"]]],[5,[2],[[8,\"watch\"]]],[6,[[8,\"「watch:」で始まるコマンドを、すべて同時に実行します。それぞれが \"],[7,\"src\"],[8,\" のファイルを監視し、変更があれば \"],[7,\"docs\"],[8,\" に出力します。\"]]],[8,[\"\\\"watch:html\\\": \\\"cpx -w src/index.html docs\\\",\\n\\\"watch:assets\\\": \\\"cpx -w \\\\\\\"src/assets/**/*\\\\\\\" docs/assets\\\",\\n\\\"watch:js\\\": \\\"cpx -w src/main.js docs\\\",\\n\\\"watch:elm\\\": \\\"elm-live src/Main.elm --open --start-page=index.html --dir=docs -- --output=docs/elm.js\\\",\\n\\\"watch:sass\\\": \\\"sass --watch src:docs\\\",\\n\\\"watch\\\": \\\"sass src:docs && npm-run-all -p watch:*\\\"\\n\",[1,\"json\"]]],[6,[[8,\"開発用のサーバーは \"],[7,\"watch:elm\"],[8,\" の elm-live が起動しています。\"]]],[5,[2],[[8,\"build\"]]],[6,[[7,\"clean\"],[8,\" \"],[7,\"compile\"],[8,\" \"],[7,\"minify:elm\"],[8,\" を順番に実行しています。\"]]],[8,[\"\\\"build\\\": \\\"npm-run-all -s clean compile minify:elm\\\",\\n\",[1,\"json\"]]],[6,[[8,\"生成したファイルは \"],[7,\"public\"],[8,\" に出力されます。出力先のディレクトリ名を変更する場合は、以下のコマンド内の \"],[7,\"public\"],[8,\" を新しい名前に書き直します。\"]]],[5,[2],[[8,\"compile\"]]],[6,[[8,\"「compile:」で始まるコマンドを、すべて同時に実行します。\"]]],[8,[\"\\\"compile:html\\\": \\\"cpx src/index.html public\\\",\\n\\\"compile:assets\\\": \\\"cpx \\\\\\\"src/assets/**/*\\\\\\\" public/assets\\\",\\n\\\"compile:js\\\": \\\"cpx src/main.js public\\\",\\n\\\"compile:elm\\\": \\\"elm make src/Main.elm --optimize --output=public/elm.optimized.js\\\",\\n\\\"compile:sass\\\": \\\"sass --style=compressed --no-source-map src:public\\\"\\n\\\"compile\\\": \\\"npm-run-all -p compile:*\\\"\\n\",[1,\"json\"]]],[6,[[5,[[8,\"注意：\"]]],[8,\" minify まで実行しないと elm.js を出力できない実装になっています。cpx でどうにかしたい。（2019 年 7 月 6 日）\"]]],[5,[2],[[8,\"minify:elm\"]]],[6,[[8,\"elm.optimized.js を圧縮し、elm.js として出力します。\"]]],[8,[\"\\\"minify:elm\\\": \\\"google-closure-compiler --js=public/elm.optimized.js --js_output_file=public/elm.js && rimraf public/elm.optimized.js\\\"\\n\",[1,\"json\"]]],[5,[0],[[8,\"付録 2： devDependencies\"]]],[6,[[8,\"使用した npm のパッケージについて簡単にコメントします。\"]]],[5,[2],[[8,\"cpx\"]]],[6,[[8,\"ファイル・フォルダのコピーを、Mac でも Windows でも出来るように。\\n\"],[7,\"--watch\"],[8,\" のオプションがあり、\"],[7,\"devDependencies\"],[8,\" の記述量を減らすことに繋がった。\\n（内部的には chokidar かな？）\\ncpx で上手くいかない場合は、ncp で妥協することになる。\"]]],[5,[2],[[8,\"elm\"]]],[6,[[8,\"Elm のコンパイラ。\"]]],[5,[2],[[8,\"elm-live\"]]],[6,[[8,\"browser-sync を試したものの、コンパイルエラーを無視してサーバーが起動してしまうため、 elm-live が最適という結論になった。\"]]],[5,[2],[[8,\"elm-test\"]]],[6,[[8,\"テスト（script 未実装）\"]]],[5,[2],[[8,\"google-closure-compiler\"]]],[6,[[8,\"Elm をコンパイルした後の js ファイルを圧縮する。\\nelm-minify が deprecated となり、こちらが推奨されていたので使用した。\"]]],[5,[2],[[1,[0,\"s\",[],[[6,[[8,\"node-sass\"]]]]]]]],[1,[0,\"s\",[],[[6,[[8,\"SASS を扱うために使用。いつか sass（Dart Sass）に変えるかもしれない。\"]]]]]],[6,[[8,\"sass（Dart Sass）に変更しました。（2019 年 7 月 9 日）\"]]],[5,[2],[[8,\"npm-run-all\"]]],[6,[[8,\"コマンドの直列実行と並列実行を読みやすく記述できる。\"]]],[5,[2],[[8,\"rimraf\"]]],[6,[[8,\"フォルダの削除を、Mac でも Windows でも出来るように。\"]]]]]","{\"method\":\"GET\",\"url\":\"file://content/posts/elm-starfighter.md\",\"headers\":[],\"body\":{\"type\":\"empty\"}}":"{\"parsedFrontmatter\":{\"title\":\"Elm での開発用テンプレート elm-starfighter を作った\",\"description\":\"\",\"published\":\"2019-07-06\"}}"}}</script>
    </head>
    <body>
      <div data-url="" display="none"></div>
      <div><style>._18a4ce68 {
    padding:0.2em 0.4em;
    margin:0;
    font-size:85%;
    background-color:rgba(27, 31, 35, 0.05);
    border-radius:3px;
}

._1f9b4344 {
    font-weight:600;
    margin:28px 0;
    padding:17px 0;
    font-size:1.125em;
    line-height:1.333;
    text-align:center;
    border-top:1px solid;
    border-bottom:1px solid;
}

._1f9b4344:nth-child(n+2) {
    margin-top:29px;
}

._21b0387d:nth-child(n+2) {
    margin-top:0.25em;
}

._21b0387d &gt; p {
    margin-top:16px;
}

._238fbf11 {
    padding-left:2em;
}

._3a71fdb5 {
    color:hsl(210, 5%, 50%);
}

._3a71fdb5 &gt; p {
    padding:5px 0;
    font-size:14px;
    line-height:1;
}

._4ee7bacd {
    font-weight:600;
    font-size:1em;
}

._4ee7bacd:nth-child(n+2) {
    margin-top:29px;
}

._5758449e {
    display:block;
    width:620px;
    margin:0 auto;
    padding:20px 0;
    font-family:&quot;Saira&quot;, sans-serif;
    font-size:18px;
    font-weight:normal;
}

@media only screen and (max-width: 480px) {
    ._5758449e {
        width:100%;
    padding:15px;
    }
}

._683cd71f {
    font-weight:600;
    margin-top:2px;
    margin-bottom:31px;
    font-size:1.25em;
    line-height:1.25;
}

._683cd71f:nth-child(n+2) {
    margin-top:29px;
}

._6a9bca95 {
    white-space:pre-wrap;
    text-decoration:none;
    color:hsl(90, 100%, 40%);
}

._6a9bca95:hover {
    text-decoration:underline;
}

._6a9bca95:visited {
    color:hsl(90, 100%, 20%);
}

._6a9bca95[target=_blank]::after {
    content:&quot;\f35d&quot;;
    position:relative;
    top:-1px;
    display:inline-block;
    padding:0 5px;
    font-family:&quot;Font Awesome 5 Free&quot;;
    font-size:12px;
    font-weight:900;
    text-decoration:none;
    color:inherit;
}

._6a9bca95[target=_blank]:visited::after {
    color:hsl(90, 100%, 20%);
}

._6c2a7992 {
    text-decoration:none;
    color:inherit;
}

._96049fe0 {
    padding:5px 0;
    font-family:&quot;-apple-system&quot;, sans-serif;
    font-size:24px;
    font-weight:600;
}

._beb10df7 {
    width:620px;
    margin:0 auto;
    padding:20px 0;
}

@media only screen and (max-width: 480px) {
    ._beb10df7 {
        width:100%;
    padding:15px;
    }
}

._c5ac4c2d {
    padding-top:20px;
    line-height:1.8;
    word-wrap:break-word;
}

._c5ac4c2d  ol ol, ._c5ac4c2d  ul ol {
    list-style-type:lower-roman;
}

._c5ac4c2d  ol ol ol, ._c5ac4c2d  ol ul ol, ._c5ac4c2d  ul ol ol, ._c5ac4c2d  ul ul ol {
    list-style-type:lower-alpha;
}

._c5ac4c2d  blockquote + blockquote, ._c5ac4c2d  blockquote + details, ._c5ac4c2d  blockquote + dl, ._c5ac4c2d  blockquote + ol, ._c5ac4c2d  blockquote + p, ._c5ac4c2d  blockquote + pre, ._c5ac4c2d  blockquote + table, ._c5ac4c2d  blockquote + ul, ._c5ac4c2d  details + blockquote, ._c5ac4c2d  details + details, ._c5ac4c2d  details + dl, ._c5ac4c2d  details + ol, ._c5ac4c2d  details + p, ._c5ac4c2d  details + pre, ._c5ac4c2d  details + table, ._c5ac4c2d  details + ul, ._c5ac4c2d  dl + blockquote, ._c5ac4c2d  dl + details, ._c5ac4c2d  dl + dl, ._c5ac4c2d  dl + ol, ._c5ac4c2d  dl + p, ._c5ac4c2d  dl + pre, ._c5ac4c2d  dl + table, ._c5ac4c2d  dl + ul, ._c5ac4c2d  ol + blockquote, ._c5ac4c2d  ol + details, ._c5ac4c2d  ol + dl, ._c5ac4c2d  ol + ol, ._c5ac4c2d  ol + p, ._c5ac4c2d  ol + pre, ._c5ac4c2d  ol + table, ._c5ac4c2d  ol + ul, ._c5ac4c2d  p + blockquote, ._c5ac4c2d  p + details, ._c5ac4c2d  p + dl, ._c5ac4c2d  p + ol, ._c5ac4c2d  p + p, ._c5ac4c2d  p + pre, ._c5ac4c2d  p + table, ._c5ac4c2d  p + ul, ._c5ac4c2d  pre + blockquote, ._c5ac4c2d  pre + details, ._c5ac4c2d  pre + dl, ._c5ac4c2d  pre + ol, ._c5ac4c2d  pre + p, ._c5ac4c2d  pre + pre, ._c5ac4c2d  pre + table, ._c5ac4c2d  pre + ul, ._c5ac4c2d  table + blockquote, ._c5ac4c2d  table + details, ._c5ac4c2d  table + dl, ._c5ac4c2d  table + ol, ._c5ac4c2d  table + p, ._c5ac4c2d  table + pre, ._c5ac4c2d  table + table, ._c5ac4c2d  table + ul, ._c5ac4c2d  ul + blockquote, ._c5ac4c2d  ul + details, ._c5ac4c2d  ul + dl, ._c5ac4c2d  ul + ol, ._c5ac4c2d  ul + p, ._c5ac4c2d  ul + pre, ._c5ac4c2d  ul + table, ._c5ac4c2d  ul + ul {
    margin-top:29px;
}

._c5ac4c2d  code, ._c5ac4c2d  pre {
    font-family:&quot;SFMono-Regular&quot;, &quot;Consolas&quot;, &quot;Liberation Mono&quot;, &quot;Menlo&quot;, monospace;
    font-size:12px;
}

._c5ac4c2d  pre {
    word-wrap:normal;
}

._c5ac4c2d  pre &gt; code {
    padding:0;
    margin:0;
    font-size:100%;
    word-break:normal;
    white-space:pre;
    background:transparent;
    border:0;
}

._c5ac4c2d  pre {
    padding:16px;
    overflow:auto;
    font-size:85%;
    line-height:1.45;
    background-color:#f6f8fa;
    border-radius:3px;
}

._c5ac4c2d  pre  code {
    display:inline;
    max-width:auto;
    padding:0;
    margin:0;
    overflow:visible;
    line-height:inherit;
    word-wrap:normal;
    background-color:initial;
    border:0;
}

._d8a7d977 {
    display:block;
    width:620px;
    margin:0 auto;
    padding:20px 0;
    text-align:right;
    font-family:&quot;Saira&quot;, sans-serif;
    font-size:14px;
}

@media only screen and (max-width: 480px) {
    ._d8a7d977 {
        width:100%;
    padding:15px;
    }
}

._e3f60c19 {
    max-width:100%;
}</style><style>html {
    box-sizing:border-box;
    -webkit-text-size-adjust:100%;
    word-break:normal;
    -moz-tab-size:4;
    tab-size:4;
}

*, ::before, ::after {
    background-repeat:no-repeat;
    box-sizing:inherit;
}

::before, ::after {
    text-decoration:inherit;
    vertical-align:inherit;
}

* {
    padding:0;
    margin:0;
}

hr {
    overflow:visible;
    height:0;
}

details, main {
    display:block;
}

summary {
    display:list-item;
}

small {
    font-size:80%;
}

[hidden] {
    display:none;
}

abbr[title] {
    border-bottom:none;
    text-decoration:underline;
    text-decoration:underline dotted;
}

a {
    background-color:transparent;
}

a:active, a:hover {
    outline-width:0;
}

code, kbd, pre, samp {
    font-family:monospace, monospace;
}

pre {
    font-size:1em;
}

b, strong {
    font-weight:bolder;
}

sub, sup {
    font-size:75%;
    line-height:0;
    position:relative;
    vertical-align:baseline;
}

sub {
    bottom:-0.25em;
}

sup {
    top:-0.5em;
}

input {
    border-radius:0;
}

[disabled] {
    cursor:default;
}

[type=&quot;number&quot;]::-webkit-inner-spin-button, [type=&quot;number&quot;]::-webkit-outer-spin-button {
    height:auto;
}

[type=&quot;search&quot;] {
    -webkit-appearance:textfield;
    outline-offset:-2px;
}

[type=&quot;search&quot;]::-webkit-search-decoration {
    -webkit-appearance:none;
}

textarea {
    overflow:auto;
    resize:vertical;
}

button, input, optgroup, select, textarea {
    font:inherit;
}

optgroup {
    font-weight:bold;
}

button {
    overflow:visible;
}

button, select {
    text-transform:none;
}

button, [type=&quot;button&quot;], [type=&quot;reset&quot;], [type=&quot;submit&quot;], [role=&quot;button&quot;] {
    cursor:pointer;
    color:inherit;
}

button::-moz-focus-inner, [type=&quot;button&quot;]::-moz-focus-inner, [type=&quot;reset&quot;]::-moz-focus-inner, [type=&quot;submit&quot;]::-moz-focus-inner {
    border-style:none;
    padding:0;
}

button:-moz-focusring, [type=&quot;button&quot;]::-moz-focus-inner, [type=&quot;reset&quot;]::-moz-focus-inner, [type=&quot;submit&quot;]::-moz-focus-inner {
    outline:1px dotted ButtonText;
}

button, html [type=&quot;button&quot;], [type=&quot;reset&quot;], [type=&quot;submit&quot;] {
    -webkit-appearance:button;
}

button, input, select, textarea {
    background-color:transparent;
    border-style:none;
}

select {
    -moz-appearance:none;
    -webkit-appearance:none;
}

select::-ms-expand {
    display:none;
}

select::-ms-value {
    color:currentColor;
}

legend {
    border:0;
    color:inherit;
    display:table;
    max-width:100%;
    white-space:normal;
    max-width:100%;
}

::-webkit-file-upload-button {
    -webkit-appearance:button;
    color:inherit;
    font:inherit;
}

img {
    border-style:none;
}

progress {
    vertical-align:baseline;
}

@media only screen {
    [hidden~=&quot;screen&quot;] {
        display:inherit;
    }
}

@media only screen {
    [hidden~=&quot;screen&quot;]:not(:active):not(:focus):not(:target) {
        position:absolute !important;
    clip:rect(0 0 0 0) !important;
    }
}

[aria-busy=&quot;true&quot;] {
    cursor:progress;
}

[aria-controls] {
    cursor:pointer;
}

[aria-disabled] {
    cursor:default;
}

body {
    font-family:&quot;-apple-system&quot;, &quot;BlinkMacSystemFont&quot;, sans-serif;
    font-feature-settings:&quot;palt&quot;;
    color:hsl(0, 0%, 20%);
}</style><header><h1 class="_5758449e"><a class="_6c2a7992" href="/">y047aka.space</a></h1></header><main><div class="_beb10df7"><header><h1 class="_96049fe0">Elm での開発用テンプレート elm-starfighter を作った</h1><div class="_3a71fdb5">July 6th, 2019</div></header><div class="_c5ac4c2d"><p>自作の Elm 開発用テンプレート「 <a class="_6a9bca95" href="https://github.com/y047aka/elm-starfighter" rel="noopener" target="_blank">elm-starfighter</a> 」が形になってきたので、その説明を書きます。</p><h1 class="_1f9b4344">elm-starfighter とは？</h1><p>関数型言語 <a class="_6a9bca95" href="https://elm-lang.org" rel="noopener" target="_blank">Elm</a> を使った Web アプリケーション開発用のテンプレートです。webpack や Parcel といったモジュールバンドラーを使用せず、<code class="_18a4ce68">npm scripts</code> で完結しています。Elm での開発に最低限必要なものをシンプルに使えるのが、elm-starfighter の特徴です。</p><ul class="_238fbf11"><li class="_21b0387d"><a class="_6a9bca95" href="https://github.com/y047aka/elm-starfighter" rel="noopener" target="_blank">elm-starfighter</a></li></ul><h2 class="_683cd71f">なぜ作ろうと思ったのか？</h2><p>JavaScript での開発と同様に、Elm においても webpack や Parcel を使った開発方法が普及しています。しかし、Elm はモジュールバンドラーを必要とはしていないかもしれません。それならばモジュールバンドラーに頼らない、よりシンプルな開発ができるのではないかと考えました。</p><p>既に知られている <a class="_6a9bca95" href="https://github.com/halfzebra/create-elm-app" rel="noopener" target="_blank">create-elm-app</a> や <a class="_6a9bca95" href="https://github.com/elm-community/elm-webpack-starter" rel="noopener" target="_blank">elm-webpack-starter</a> に対して「毎回使うには大きすぎる」と感じたことも動機の 1 つです。Elm 入門者が簡単に使える開発ツールがあれば、Elm の持つ魅力をもっと引き出せるのではないかと思います。</p><h2 class="_683cd71f">開発の方針</h2><h3 class="_4ee7bacd">Elm 入門者に優しく</h3><p>公式ガイドや『基礎からわかる Elm』を読んだあとで、すぐに使ってもらえるよう意識して作りました。使い方に迷うようなところがあれば改善していきたい。</p><h3 class="_4ee7bacd">Elm の持つ魅力を引き出す</h3><p>JavaScript と Elm では何が違うのかを意識しながら作りました。標準の <code class="_18a4ce68">elm make</code> コマンドはデバッグ機能を使うことができますし、そこに開発用サーバー機能を付加した <code class="_18a4ce68">elm-live</code> も非常に強力です。それらの良さを残しつつ、苦手な部分を補うようにしました。</p><h3 class="_4ee7bacd">モジュールバンドラーと戦わない</h3><p>適材適所を意識すること。例えば、Port を積極的に使うならモジュールバンドラーの方が有利のはず。
（私は Port をほとんど使わないので、推測で言っています）</p><h2 class="_683cd71f">謝辞</h2><p>@ababup1192 さんには、開発初期の段階で多くの相談に乗っていただきました。ありがとうございました。</p><h1 class="_1f9b4344">簡単に使えるので書くことがない</h1><p>いちばん簡単な試し方は以下のコマンドを実行する方法です。</p><pre><code>$ git clone https://github.com/y047aka/elm-starfighter.git
$ cd elm-startfighter
$ npm install
$ npm start
</code></pre><p>また、リポジトリのトップから緑色のボタン「Use this template」を選択すると、elm-starfighter を使った新しいリポジトリを作る事もできます。
<img class="_e3f60c19" alt="" src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/406109/3faa5b0f-8ff3-9280-fa09-6ba62e3495e8.png"></p><h2 class="_683cd71f">npm start</h2><p><code class="_18a4ce68">npm start</code> を実行すると、</p><ol class="_238fbf11" start="1"><li class="_21b0387d"><code class="_18a4ce68">docs</code> にファイルが生成され</li><li class="_21b0387d">開発用サーバーが起動し</li><li class="_21b0387d">ブラウザに最初のページが表示されます</li></ol><h2 class="_683cd71f">npm run build</h2><p>もう 1 つのコマンドは <code class="_18a4ce68">npm run build</code> で起動します。</p><ol class="_238fbf11" start="1"><li class="_21b0387d"><code class="_18a4ce68">public</code> にファイルが生成されます</li></ol><p>生成前のファイルはすべて <code class="_18a4ce68">src</code> にあるので、いつも通りに開発を進められます。</p><pre><code>src
 - index.html
 - main.js
 - Main.elm
 - style.sass または style.sass
 - assets（画像など）
</code></pre><h2 class="_683cd71f">ディレクトリ名について</h2><p><code class="_18a4ce68">docs</code> は Github Pages を、<code class="_18a4ce68">public</code> は Netlify をすぐに使えるよう意図して設定しています。</p><h1 class="_1f9b4344">おわり</h1><p>この記事の本編は、ここで終了です。
カスタマイズして使う場合には以下の付録を参考にしてください。</p><h1 class="_1f9b4344">付録 1： package.json を読む</h1><p>ここに elm-starfighter のすべてがあります。webpack や Parcel の姿はなく、代わりに <code class="_18a4ce68">npm scripts</code> が並んでいます。<code class="_18a4ce68">elm make</code> コマンドや <code class="_18a4ce68">elm-live</code> を使っていることが分かりますね。これから <code class="_18a4ce68">scripts</code> を詳しく見ていきましょう。</p><pre><code>{
  &quot;scripts&quot;: {
    &quot;clean&quot;: &quot;rimraf docs public&quot;,
    &quot;watch:html&quot;: &quot;cpx -w src/index.html docs&quot;,
    &quot;watch:assets&quot;: &quot;cpx -w \&quot;src/assets/**/*\&quot; docs/assets&quot;,
    &quot;watch:js&quot;: &quot;cpx -w src/main.js docs&quot;,
    &quot;watch:elm&quot;: &quot;elm-live src/Main.elm --open --start-page=index.html --dir=docs -- --output=docs/elm.js&quot;,
    &quot;watch:sass&quot;: &quot;sass --watch src:docs&quot;,
    &quot;watch&quot;: &quot;sass src:docs &amp;&amp; npm-run-all -p watch:*&quot;,
    &quot;compile:html&quot;: &quot;cpx src/index.html public&quot;,
    &quot;compile:assets&quot;: &quot;cpx \&quot;src/assets/**/*\&quot; public/assets&quot;,
    &quot;compile:js&quot;: &quot;cpx src/main.js public&quot;,
    &quot;compile:elm&quot;: &quot;elm make src/Main.elm --optimize --output=public/elm.optimized.js&quot;,
    &quot;compile:sass&quot;: &quot;sass --style=compressed --no-source-map src:public&quot;,
    &quot;compile&quot;: &quot;npm-run-all -p compile:*&quot;,
    &quot;minify:elm&quot;: &quot;google-closure-compiler --js=public/elm.optimized.js --js_output_file=public/elm.js &amp;&amp; rimraf public/elm.optimized.js&quot;,
    &quot;build&quot;: &quot;npm-run-all -s clean compile minify:elm&quot;,
    &quot;start&quot;: &quot;npm-run-all -s clean watch&quot;,
    &quot;test&quot;: &quot;elm-test&quot;
  },
  &quot;devDependencies&quot;: {
    &quot;cpx&quot;: &quot;^1.5.0&quot;,
    &quot;elm&quot;: &quot;0.19.0-bugfix6&quot;,
    &quot;elm-live&quot;: &quot;3.4.0&quot;,
    &quot;elm-test&quot;: &quot;^0.19.0-rev6&quot;,
    &quot;google-closure-compiler&quot;: &quot;^20190819.0.0&quot;,
    &quot;npm-run-all&quot;: &quot;^4.1.5&quot;,
    &quot;rimraf&quot;: &quot;^3.0.0&quot;,
    &quot;sass&quot;: &quot;^1.22.10&quot;
  }
}
</code></pre><h2 class="_683cd71f">npm scripts</h2><p>以下の 4 種類のコマンドを <code class="_18a4ce68">start</code> と <code class="_18a4ce68">build</code> から実行しています。</p><ul class="_238fbf11"><li class="_21b0387d">clean</li><li class="_21b0387d">watch</li><li class="_21b0387d">compile</li><li class="_21b0387d">minify:elm</li></ul><h3 class="_4ee7bacd">start</h3><p><code class="_18a4ce68">clean</code> と <code class="_18a4ce68">watch</code> を順番に実行します。</p><pre><code>&quot;start&quot;: &quot;npm-run-all -s clean watch&quot;
</code></pre><p>生成したファイルは <code class="_18a4ce68">docs</code> に出力されます。出力先のディレクトリ名を変更する場合は、以下のコマンド内の <code class="_18a4ce68">docs</code> を新しい名前に書き直します。（実際には package.json をエディタで一括変換すれば問題ありません）</p><h3 class="_4ee7bacd">clean</h3><p><code class="_18a4ce68">docs</code> と <code class="_18a4ce68">public</code> ディレクトリを 2 つとも削除します。このコマンドのみ、<code class="_18a4ce68">build</code> と共有しています。</p><pre><code>&quot;clean&quot;: &quot;rimraf docs public&quot;
</code></pre><h3 class="_4ee7bacd">watch</h3><p>「watch:」で始まるコマンドを、すべて同時に実行します。それぞれが <code class="_18a4ce68">src</code> のファイルを監視し、変更があれば <code class="_18a4ce68">docs</code> に出力します。</p><pre><code>&quot;watch:html&quot;: &quot;cpx -w src/index.html docs&quot;,
&quot;watch:assets&quot;: &quot;cpx -w \&quot;src/assets/**/*\&quot; docs/assets&quot;,
&quot;watch:js&quot;: &quot;cpx -w src/main.js docs&quot;,
&quot;watch:elm&quot;: &quot;elm-live src/Main.elm --open --start-page=index.html --dir=docs -- --output=docs/elm.js&quot;,
&quot;watch:sass&quot;: &quot;sass --watch src:docs&quot;,
&quot;watch&quot;: &quot;sass src:docs &amp;&amp; npm-run-all -p watch:*&quot;
</code></pre><p>開発用のサーバーは <code class="_18a4ce68">watch:elm</code> の elm-live が起動しています。</p><h3 class="_4ee7bacd">build</h3><p><code class="_18a4ce68">clean</code> <code class="_18a4ce68">compile</code> <code class="_18a4ce68">minify:elm</code> を順番に実行しています。</p><pre><code>&quot;build&quot;: &quot;npm-run-all -s clean compile minify:elm&quot;,
</code></pre><p>生成したファイルは <code class="_18a4ce68">public</code> に出力されます。出力先のディレクトリ名を変更する場合は、以下のコマンド内の <code class="_18a4ce68">public</code> を新しい名前に書き直します。</p><h3 class="_4ee7bacd">compile</h3><p>「compile:」で始まるコマンドを、すべて同時に実行します。</p><pre><code>&quot;compile:html&quot;: &quot;cpx src/index.html public&quot;,
&quot;compile:assets&quot;: &quot;cpx \&quot;src/assets/**/*\&quot; public/assets&quot;,
&quot;compile:js&quot;: &quot;cpx src/main.js public&quot;,
&quot;compile:elm&quot;: &quot;elm make src/Main.elm --optimize --output=public/elm.optimized.js&quot;,
&quot;compile:sass&quot;: &quot;sass --style=compressed --no-source-map src:public&quot;
&quot;compile&quot;: &quot;npm-run-all -p compile:*&quot;
</code></pre><p><strong>注意：</strong> minify まで実行しないと elm.js を出力できない実装になっています。cpx でどうにかしたい。（2019 年 7 月 6 日）</p><h3 class="_4ee7bacd">minify:elm</h3><p>elm.optimized.js を圧縮し、elm.js として出力します。</p><pre><code>&quot;minify:elm&quot;: &quot;google-closure-compiler --js=public/elm.optimized.js --js_output_file=public/elm.js &amp;&amp; rimraf public/elm.optimized.js&quot;
</code></pre><h1 class="_1f9b4344">付録 2： devDependencies</h1><p>使用した npm のパッケージについて簡単にコメントします。</p><h3 class="_4ee7bacd">cpx</h3><p>ファイル・フォルダのコピーを、Mac でも Windows でも出来るように。
<code class="_18a4ce68">--watch</code> のオプションがあり、<code class="_18a4ce68">devDependencies</code> の記述量を減らすことに繋がった。
（内部的には chokidar かな？）
cpx で上手くいかない場合は、ncp で妥協することになる。</p><h3 class="_4ee7bacd">elm</h3><p>Elm のコンパイラ。</p><h3 class="_4ee7bacd">elm-live</h3><p>browser-sync を試したものの、コンパイルエラーを無視してサーバーが起動してしまうため、 elm-live が最適という結論になった。</p><h3 class="_4ee7bacd">elm-test</h3><p>テスト（script 未実装）</p><h3 class="_4ee7bacd">google-closure-compiler</h3><p>Elm をコンパイルした後の js ファイルを圧縮する。
elm-minify が deprecated となり、こちらが推奨されていたので使用した。</p><h3 class="_4ee7bacd"><s><p>node-sass</p></s></h3><s><p>SASS を扱うために使用。いつか sass（Dart Sass）に変えるかもしれない。</p></s><p>sass（Dart Sass）に変更しました。（2019 年 7 月 9 日）</p><h3 class="_4ee7bacd">npm-run-all</h3><p>コマンドの直列実行と並列実行を読みやすく記述できる。</p><h3 class="_4ee7bacd">rimraf</h3><p>フォルダの削除を、Mac でも Windows でも出来るように。</p></div></div></main><footer><p class="_d8a7d977">© 2021 y047aka</p></footer></div>
    </body>
  </html>
  